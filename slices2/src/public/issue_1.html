<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>灵魂拷问</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/issue.css">
    <script src="js/jquery.min.js"></script>
    <script src="js/base.js"></script>
</head>
<body>

<!--<audio id="music" src="bgMusic.mp3"  loop="loop">你的浏览器不支持audio标签</audio>-->
<a href="javascript:playPause();" id="playMusic"><img src="images/audioOn.png" id="music_btn"></a>
<div id="start">
    <a href="javascript:;" id="startBtn"></a>
</div>


<div id='swap' class="w">
    <form id="form1" onsubmit="return false">
        <div class="issue_img issue_1_img"></div>
        <div class="main">
            <div class="issue_1">
                <label class="item clf">
                    <i class="option option_a fl"></i>
                    <input type="radio" name="issue_1" class="issue_a" value="a">
                </label>
                <label class="item clf">
                    <i class="option option_b fl"></i>
                    <input type="radio" name="issue_1" class="issue_b" value="b">
                </label>
                <label class="item clf">
                    <i class="option option_c fl"></i>
                    <input type="radio" name="issue_1" class="issue_c" value="c">
                </label>
                <label class="item clf">
                    <i class="option option_d fl"></i>
                    <input type="radio" name="issue_1" class="issue_d" value="d">
                </label>
            </div>
            <button id="nextQuestion"></button>
        </div>
    </form>

    <form id="form2" onsubmit="return false">
        <div class="issue_img issue_2_img"></div>
        <div class="main">
            <div class="issue_2">
                <label class="item clf">
                    <i class="option option_a fl"></i>
                    <input type="radio" name="issue_2" class="issue_a" value="a">
                </label>
                <label class="item clf">
                    <i class="option option_b fl"></i>
                    <input type="radio" name="issue_2" class="issue_b" value="b">
                </label>
                <label class="item clf">
                    <i class="option option_c fl"></i>
                    <input type="radio" name="issue_2" class="issue_c" value="c">
                </label>
                <label class="item clf">
                    <i class="option option_d fl"></i>
                    <input type="radio" name="issue_2" class="issue_d" value="d">
                </label>
            </div>
            <button id="nextQuestion"></button>
        </div>
    </form>

    <form id="form3" onsubmit="return false">
        <div class="issue_img issue_3_img"></div>
        <div class="main">
            <div class="issue_3">
                <label class="item clf">
                    <i class="option option_a fl"></i>
                    <input type="radio" name="issue_3" class="issue_a" value="a">
                </label>
                <label class="item clf">
                    <i class="option option_b fl"></i>
                    <input type="radio" name="issue_3" class="issue_b" value="b">
                </label>
                <label class="item clf">
                    <i class="option option_c fl"></i>
                    <input type="radio" name="issue_3" class="issue_c" value="c">
                </label>
                <label class="item clf">
                    <i class="option option_d fl"></i>
                    <input type="radio" name="issue_3" class="issue_d" value="d">
                </label>
            </div>
            <button id="nextQuestion"></button>
        </div>
    </form>

    <form id="form4" onsubmit="return false">
        <div class="issue_img issue_4_img"></div>
        <div class="main">
            <div class="issue_4">
                <label class="item clf">
                    <i class="option option_a fl"></i>
                    <input type="radio" name="issue_4" class="issue_a" value="a">
                </label>
                <label class="item clf">
                    <i class="option option_b fl"></i>
                    <input type="radio" name="issue_4" class="issue_b" value="b">
                </label>
                <label class="item clf">
                    <i class="option option_c fl"></i>
                    <input type="radio" name="issue_4" class="issue_c" value="c">
                </label>
                <label class="item clf">
                    <i class="option option_d fl"></i>
                    <input type="radio" name="issue_4" class="issue_d" value="d">
                </label>
            </div>
            <button id="nextQuestion"></button>
        </div>
    </form>

    <form id="form5" onsubmit="return false">
        <div class="issue_img issue_5_img"></div>
        <div class="main">
            <div class="issue_3">
                <label class="item clf">
                    <i class="option option_a fl"></i>
                    <input type="radio" name="issue_5" class="issue_a" value="a">
                </label>
                <label class="item clf">
                    <i class="option option_b fl"></i>
                    <input type="radio" name="issue_5" class="issue_b" value="b">
                </label>
                <label class="item clf">
                    <i class="option option_c fl"></i>
                    <input type="radio" name="issue_5" class="issue_c" value="c">
                </label>
                <label class="item clf">
                    <i class="option option_d fl"></i>
                    <input type="radio" name="issue_5" class="issue_d" value="d">
                </label>
            </div>
            <button id="nextQuestion"></button>
        </div>
    </form>
</div>
<div id="result">
    <div id="resultDetail">
        <!--<div id="resultImg" class="result_a"><img src="images/qrcode.png" class="qrcode"></div>-->
        <div id="resultImg"><img src="images/qrcode.png" class="qrcode"></div>
    </div>
    <p>长按保存图片</p>
    <a href="javascript:;" id="shareBtn"></a>
</div>
<div id="layer"></div>

<script type="text/javascript">
    var num = 1;
    var result = {};
    var stat = {};
    $(document).ready(function () {
        $("#form1").submit(function (e) {
            e.preventDefault();
            const value = e.target.issue_1.value;
            if (value != "") {
                result[num] = value;
                stat[value] = stat[value] + 1 || 1
                $("#form1").hide();
                $("#form2").show();
                num += 1;
            }
        });

        $("#form2").submit(function (e) {
            e.preventDefault();
            const value = e.target.issue_2.value;
            if (value != "") {
                result[num] = value;
                stat[value] = stat[value] + 1 || 1
                $("#form2").hide();
                $("#form3").show();
                num += 1;
            }
        });

        $("#form3").submit(function (e) {
            e.preventDefault();
            const value = e.target.issue_3.value;
            if (value != "") {
                result[num] = value;
                stat[value] = stat[value] + 1 || 1
                $("#form3").hide();
                $("#form4").show();
                num += 1;
            }
        });


        $("#form4").submit(function (e) {
            e.preventDefault();
            const value = e.target.issue_4.value;
            if (value != "") {
                result[num] = value;
                stat[value] = stat[value] + 1 || 1
                $("#form4").hide();
                $("#form5").show();
                num += 1;
            }
        });

        $("#form5").submit(function (e) {
            e.preventDefault();
            console.log(e.target.issue_5.value);
            const value = e.target.issue_5.value;
            if (value != "") {
                result[num] = value;
                stat[value] = stat[value] + 1 || 1
                $("#swap").hide();
                var max = getMaxIndex(stat);
                console.log('=============================', 'result_' + max)
                $("#resultImg").addClass('result_' + max)
                $("#result").show();

            }
            console.log("====result==", result, '============', value == "")
        });
    });

    function getMaxIndex(obj) {
        var max = 'a';
        var max_value = 0;
        for (var key in obj) {
            if (obj[key] > max_value) {
                max = key;
                max_value = obj[key];
            }
        }
        return max;
    }

</script>

<script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script>
    $.ajax({
        url:"http://ceibs.54jj.cn/chunjie/api/wx?url=" + window.location.href,
        type:"get",
        dataType:"json",
        async:false,
        success:function(data) {
            // console.log(data); return;
            var appIdVal=data.appId;
            var timestampVal=data.timestamp;
            var nonceStrVal=data.nonceStr;
            var signatureVal=encodeURIComponent(data.signature);
            wx.config({
                debug: false,
                // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                appId: appIdVal,
                // 必填，公众号的唯一标识
                timestamp: timestampVal,
                // 必填，生成签名的时间戳
                nonceStr: nonceStrVal,
                // 必填，生成签名的随机串
                signature: signatureVal,
                // 必填，签名
                jsApiList: [
                    'onMenuShareAppMessage',//分享给好友
                    'onMenuShareTimeline',//分享到朋友圈
                    'onMenuShareQQ',//分享到QQ好友
                    'onMenuShareWeibo',//分享到微博
                    'onMenuShareQZone'//分享QQ空间
                ] // 必填，需要使用的JS接口列表
            });
        },
        error:function(){
            alert("您好，服务器繁忙中，请稍后重试  ");
        }
    });

    console.log('======================================', stat)

    wx.ready(function() {
        console.log('====================33==================', stat)
        var shareTitle="中欧华南最佳推荐人活动";
        var shareDesc="寻找一个对你我而言，十分重要的人";
        // var linkUrl="http://ceibs.54jj.cn/zhongou/index.html";
        var linkUrl=window.location.href;
        var imgUrl="http://ceibs.54jj.cn/chunjie/images/result_1.jpg";

        // 分享给微信好友
        wx.onMenuShareAppMessage({
            title:shareTitle,
            // 分享标题
            desc:shareDesc,
            // 分享描述
            link:linkUrl,
            // 分享链接
            imgUrl:imgUrl,
            // 分享图标
            type: 'link',
            // 分享类型,music、video或link，不填默认为link
            dataUrl: '',
            // 如果type是music或video，则要提供数据链接，默认为空
            success: function() {
            },
            cancel: function() {
                // 用户取消分享后执行的回调函数
            }
        });

        // 分享到朋友圈
        wx.onMenuShareTimeline({
            title:shareTitle,
            // 分享标题
            desc:shareDesc,
            // 分享描述
            link:linkUrl,
            // 分享链接
            imgUrl:imgUrl,
            // 分享图标
            type: 'link',
            // 分享类型,music、video或link，不填默认为link
            dataUrl: '',
            // 如果type是music或video，则要提供数据链接，默认为空
            success: function(res) {
            },
            cancel: function(res) {
                // 用户取消分享后执行的回调函数
            },
            fail: function(res) {
                // 用户取消分享后执行的回调函数
            }
        });
        wx.error(function(res) {
            // config信息验证失败会执行error函数，如签名过期导致验证失败
        });
    });
</script>

<script>
    function playPause() {
        var music = document.getElementById('music');
        var music_btn = document.getElementById('music_btn');
        if (music.paused) {
            music.play();
            music_btn.src = 'images/audioOn.png';
        }
        else {
            music.pause();
            music_btn.src = 'images/audioOff.png';
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        function audioAutoPlay() {
            var music = document.getElementById('music');
            music.play();
            document.addEventListener("WeixinJSBridgeReady", function () {
                music.play();
            }, false);
        }

        audioAutoPlay();
    });
</script>

</body>
</html>