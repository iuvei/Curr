<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="format-detection" content="telephone=no">
    <meta name="renderer" content="webkit">
    <title>中欧</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/css.css">
</head>
<body>
<div class="box">
    <div class="logo"><img src="images/logo1.png" alt=""></div>
    <div class="ranking">
        <div class="title">魅力值排行榜</div>
        <div class="ph_table"><a id="classPaihang" href="paihang.html?type=1" class="active">班级排行</a>
            <a id="personalPaihang" href="paihang.html?type=2">个人排行</a></div>
        <ul id="paihang">
            <li class="clf">
                <div id="r1" class="dv1">班级名称</div>
                <div id="r2" class="dv1">魅力值</div>
            </li>
            <!--<li class="clf">-->
            <!--<div class="dv1">1 <span>EMBA2005-SZ</span></div>-->
            <!--<div class="dv2">860人</div>-->
            <!--</li>-->
            <!--<li class="clf">-->
            <!--<div class="dv1">1 <span>EMBA2005-SZ</span></div>-->
            <!--<div class="dv2">860人</div>-->
            <!--</li>-->
            <!--<li class="clf">-->
            <!--<div class="dv1">1 <span>EMBA2005-SZ</span></div>-->
            <!--<div class="dv2">860人</div>-->
            <!--</li>-->
            <!--<li class="clf">-->
            <!--<div class="dv1">1 <span>EMBA2005-SZ</span></div>-->
            <!--<div class="dv2">860人</div>-->
            <!--</li>-->
            <!--<li class="clf">-->
            <!--<div class="dv1">1 <span>EMBA2005-SZ</span></div>-->
            <!--<div class="dv2">860人</div>-->
            <!--</li>-->
        </ul>
        <div class="btn"><a href="canyu1.html">返回</a></div>

    </div>
</div>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        const type = getQueryStringByName("type")
        if (type==1) {
            document.getElementById("classPaihang").setAttribute("class", "active");
            document.getElementById("personalPaihang").setAttribute("class", "");
            document.getElementById("r1").innerHTML = "班级名称";

        }
        if (type==2) {
            document.getElementById("classPaihang").setAttribute("class", "");
            document.getElementById("personalPaihang").setAttribute("class", "active");
            document.getElementById("r1").innerHTML = "姓名";
        }
        console.log(type)
        $.ajax({
            type: 'get',
            url: '/api/stat?type=' + type,
//        data: JSON.stringify(req),
//        contentType: "application/json",
//        dataType: 'json'
        }).done(function (data) {
            var parent = document.getElementById('paihang');
            for (var key in data) {
                console.log(key);
                var li = document.createElement("li");
                li.setAttribute("class", "clf");
                //添加 div
                var div = document.createElement("div");
                //设置 div 属性，如 id
                div.setAttribute("class", "dv1");
                var span = document.createElement("span");
                span.innerHTML = key
                div.appendChild(span)

                var div2 = document.createElement("div");
                div2.setAttribute("class", "dv2");
                div2.innerHTML = data[key]

                li.appendChild(div)
                li.appendChild(div2)
                parent.appendChild(li);
            }
        }).fail(function (error) {
            console.error(error);
        })
    });


    function getQueryStringByName(name) {
        var result = location.search.match(new RegExp("[\?\&]" + name + "=([^\&]+)", "i"));
        if (result == null || result.length < 1) {
            return "";
        }
        return result[1];
    }


</script>
</body>
</html>